import{M as z,j as s,i as B,u as $,P as S,a as H,b as W,L as A,s as P,m as D}from"./siteContent.BjUxXPBG.js";import{r}from"./index.Cd_vQiNd.js";function I(t,i){if(typeof t=="function")return t(i);t!=null&&(t.current=i)}function F(...t){return i=>{let n=!1;const l=t.map(a=>{const e=I(a,i);return!n&&typeof e=="function"&&(n=!0),e});if(n)return()=>{for(let a=0;a<l.length;a++){const e=l[a];typeof e=="function"?e():I(t[a],null)}}}}function K(...t){return r.useCallback(F(...t),t)}class U extends r.Component{getSnapshotBeforeUpdate(i){const n=this.props.childRef.current;if(n&&i.isPresent&&!this.props.isPresent){const l=n.offsetParent,a=B(l)&&l.offsetWidth||0,e=this.props.sizeRef.current;e.height=n.offsetHeight||0,e.width=n.offsetWidth||0,e.top=n.offsetTop,e.left=n.offsetLeft,e.right=a-e.width-e.left}return null}componentDidUpdate(){}render(){return this.props.children}}function G({children:t,isPresent:i,anchorX:n,root:l}){const a=r.useId(),e=r.useRef(null),m=r.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=r.useContext(z),x=K(e,t?.ref);return r.useInsertionEffect(()=>{const{width:c,height:u,top:d,left:p,right:b}=m.current;if(i||!e.current||!c||!u)return;const v=n==="left"?`left: ${p}`:`right: ${b}`;e.current.dataset.motionPopId=a;const h=document.createElement("style");o&&(h.nonce=o);const w=l??document.head;return w.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${u}px !important;
            ${v}px !important;
            top: ${d}px !important;
          }
        `),()=>{w.contains(h)&&w.removeChild(h)}},[i]),s.jsx(U,{isPresent:i,childRef:e,sizeRef:m,children:r.cloneElement(t,{ref:x})})}const V=({children:t,initial:i,isPresent:n,onExitComplete:l,custom:a,presenceAffectsLayout:e,mode:m,anchorX:o,root:x})=>{const c=$(X),u=r.useId();let d=!0,p=r.useMemo(()=>(d=!1,{id:u,initial:i,isPresent:n,custom:a,onExitComplete:b=>{c.set(b,!0);for(const v of c.values())if(!v)return;l&&l()},register:b=>(c.set(b,!1),()=>c.delete(b))}),[n,c,l]);return e&&d&&(p={...p}),r.useMemo(()=>{c.forEach((b,v)=>c.set(v,!1))},[n]),r.useEffect(()=>{!n&&!c.size&&l&&l()},[n]),m==="popLayout"&&(t=s.jsx(G,{isPresent:n,anchorX:o,root:x,children:t})),s.jsx(S.Provider,{value:p,children:t})};function X(){return new Map}const j=t=>t.key||"";function N(t){const i=[];return r.Children.forEach(t,n=>{r.isValidElement(n)&&i.push(n)}),i}const Y=({children:t,custom:i,initial:n=!0,onExitComplete:l,presenceAffectsLayout:a=!0,mode:e="sync",propagate:m=!1,anchorX:o="left",root:x})=>{const[c,u]=H(m),d=r.useMemo(()=>N(t),[t]),p=m&&!c?[]:d.map(j),b=r.useRef(!0),v=r.useRef(d),h=$(()=>new Map),[w,L]=r.useState(d),[y,k]=r.useState(d);W(()=>{b.current=!1,v.current=d;for(let g=0;g<y.length;g++){const f=j(y[g]);p.includes(f)?h.delete(f):h.get(f)!==!0&&h.set(f,!1)}},[y,p.length,p.join("-")]);const R=[];if(d!==w){let g=[...d];for(let f=0;f<y.length;f++){const C=y[f],E=j(C);p.includes(E)||(g.splice(f,0,C),R.push(C))}return e==="wait"&&R.length&&(g=R),k(N(g)),L(d),null}const{forceRender:O}=r.useContext(A);return s.jsx(s.Fragment,{children:y.map(g=>{const f=j(g),C=m&&!c?!1:d===y||p.includes(f),E=()=>{if(h.has(f))h.set(f,!0);else return;let M=!0;h.forEach(T=>{T||(M=!1)}),M&&(O?.(),k(v.current),m&&u?.(),l&&l())};return s.jsx(V,{isPresent:C,initial:!b.current||n?void 0:!1,custom:i,presenceAffectsLayout:a,mode:e,root:x,onExitComplete:C?void 0:E,anchorX:o,children:g},f)})})};function J({headings:t}){const[i,n]=r.useState(""),[l,a]=r.useState(!1),e=t.filter(o=>o.depth===2||o.depth===3);r.useEffect(()=>{const o=c=>{const u=c.find(d=>d.isIntersecting);u&&n(u.target.id)},x=new IntersectionObserver(o,{rootMargin:"-100px 0px -66% 0px",threshold:0});return e.forEach(c=>{const u=document.getElementById(c.slug);u&&x.observe(u)}),()=>x.disconnect()},[e]);const m=o=>{const x=document.getElementById(o);if(x){const d=x.getBoundingClientRect().top+window.pageYOffset-100,p=window.matchMedia("(prefers-reduced-motion: reduce)").matches;window.scrollTo({top:d,behavior:p?"auto":"smooth"}),n(o),a(!1)}};return e.length===0?null:s.jsxs(s.Fragment,{children:[s.jsxs("nav",{className:"hidden lg:block sticky top-32 self-start w-64 max-h-[calc(100vh-8rem)] overflow-y-auto pr-4 custom-scrollbar",children:[s.jsx("h2",{className:"text-xs font-bold text-[var(--color-text-tertiary)] uppercase tracking-widest mb-6",children:P.blog.toc.title}),s.jsx("ul",{className:"space-y-3 border-l border-[var(--color-border-default)]",children:e.map(o=>s.jsx("li",{className:`pl-4 ${o.depth===3?"ml-2":""}`,children:s.jsx("button",{onClick:()=>m(o.slug),className:`text-sm text-left transition-all duration-200 hover:text-[var(--color-accent-primary)] block w-full ${i===o.slug?"text-[var(--color-accent-primary)] font-bold -ml-[17px] border-l-2 border-[var(--color-accent-primary)] pl-[15px]":"text-[var(--color-text-secondary)] font-medium"}`,children:o.text})},o.slug))})]}),s.jsxs("div",{className:"lg:hidden mb-8 relative z-40",children:[s.jsxs("button",{onClick:()=>a(!l),className:"flex items-center justify-between w-full p-4 bg-[var(--color-bg-paper)] border border-[var(--color-border-default)] rounded-lg text-[var(--color-text-primary)] font-bold shadow-sm",children:[s.jsx("span",{children:P.blog.toc.mobileTitle}),s.jsx("svg",{className:`w-5 h-5 transition-transform duration-300 ${l?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s.jsx(Y,{children:l&&s.jsx(D.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden absolute top-full left-0 right-0 mt-2 rounded-lg shadow-xl border border-[var(--color-border-default)] bg-[var(--color-bg-paper)]",children:s.jsx("ul",{className:"p-4 space-y-3 max-h-64 overflow-y-auto",children:e.map(o=>s.jsx("li",{className:`${o.depth===3?"pl-4":""}`,children:s.jsx("button",{onClick:()=>m(o.slug),className:`text-sm text-left w-full transition-colors ${i===o.slug?"text-[var(--color-accent-primary)] font-bold":"text-[var(--color-text-secondary)] font-medium"}`,children:o.text})},o.slug))})})})]})]})}export{J as default};
